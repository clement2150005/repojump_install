# ~/.local/bin/repojump_completion

_repojump_completion() {
	local cur="${COMP_WORDS[1]}"
	local options="help add set-token"

	# Collect repo names from saved lists
	for listfile in "$HOME"/repojump/*/.*.list; do
		if [[ -f "$listfile" ]]; then
			while read -r url; do
				repo=$(basename "${url%.git}")
				options+=" $repo"
			done < "$listfile"
		fi
	done

	COMPREPLY=( $(compgen -W "$options" -- "$cur") )
}

complete -F _repojump_completion repojump
